<!DOCTYPE html><html lang=en> <head><meta charset=utf-8><title>How to redirect a static website on the Github Pages :: Vorakl's notes</title><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=robots content=all><link href=https://vorakl.com/articles/canonical/ rel=canonical><meta name=description content="The use case for a Temporary Redirect and the Canonical Link Element"><link rel=stylesheet href="https://vorakl.com/theme/bootstrap-pygments.bundle.min.css?v=1708456549"><link rel=alternate type=application/atom+xml href=https://vorakl.com/atom.xml title="Vorakl's notes"><meta name=theme-color content=#205081><link rel="shortcut icon" href="/favicon.ico?v=1708456549"><link rel=apple-touch-icon sizes=180x180 href="/favicon/apple-touch-icon.png?v=1708456549"><link rel=icon type=image/png sizes=32x32 href="/favicon/favicon-32x32.png?v=1708456549"><link rel=icon type=image/png sizes=16x16 href="/favicon/favicon-16x16.png?v=1708456549"><link rel=manifest href="/favicon/manifest.json?v=1708456549"><meta name=apple-mobile-web-app-title content="Vorakl's notes"><meta name=application-name content="Vorakl's notes"></head> <body> <div class=navbar> <div class=navbar-inner> <div class=container> <a href=https://vorakl.com/ class=brand>Vorakl's notes</a> <div class=nav-collapse> <ul class="nav pull-right"> <!-- <li class="divider-vertical"></li> --> <li><a href=https://vorakl.com/pages/reading/ >Reading</a></li> <li><a href=https://vorakl.com/pages/projects/ >Projects</a></li> <li><a href=https://vorakl.com/pages/contacts/ >Contacts</a></li> <li><a href=https://vorakl.com/pages/about/ >About</a></li> <!-- <li class="divider-vertical"></li> --> </ul> </div> </div> </div> </div> <div class=container> <div class=content> <div class=row> <div class=span12> <div class=article> <div class=content-title> <h2>How to redirect a static website on the Github Pages</h2> <div class="well small">on 2019-07-02 in <a href=https://vorakl.com/categories/howto/ >howto</a> about <a href=https://vorakl.com/tags/it/ >it</a> <a href=https://vorakl.com/tags/web/ >web</a> <a href=https://vorakl.com/tags/html/ >html</a> <a href=https://vorakl.com/tags/http/ >http</a> ~4 min read </div> <p><h3>The use case for a Temporary Redirect and the Canonical Link Element</h3></p> </div> <div class=content><p>I run a few static websites for my private projects on the <a href=https://pages.github.com/ class="reference external">Github Pages</a>. I'm absolutely happy with the service, as it supports custom domains, automatically redirects to HTTPS, and transparently installs SSL certificates (with automatic issuing via <a href=https://letsencrypt.org/ class="reference external">Let's Encrypt</a>). It is very fast (thanks to <a href=https://www.fastly.com/ class="reference external">Fastly</a>'s content delivery network) and is extremely reliable (I haven't had any issues for years). Taking into account the fact that I get all of this for free, it perfectly matches my needs at the moment. It has, however, one important limitation: because it serves static websites only, this means no query parameters, no dynamic content generated on the server side, no options for injecting any server-side configuration (e.g., .htaccess), and the only things I can push to the website's root directory are <em>static assets</em> (e.g., HTML, CSS, JS, JPEG, etc.). In general, this is not a big issue. There are a lot of the open source <a href=https://www.staticgen.com/ class="reference external">static site generators</a> available, such as <a href=https://jekyllrb.com/ class="reference external">Jekyll</a>, which is available by default the dashboard, and <a class="reference external" href=https://github.com/getpelican/pelican>Pelican</a>, which I prefer in most cases. Nevertheless, when you need to implement something that is traditionally solved on the server side, a whole new level of challenge begins.</p> <div class=line-block> <div class=line><br></div> </div> <p>For example, I recently had to change a custom domain name for one of my websites. Keeping the old one was ridiculously expensive, and I wasn't willing to continue wasting money. I found a cheaper alternative and immediately faced a bigger problem: all the search engines have the old name in their indexes. Updating indexes takes time, and until that happens, I would have to redirect all requests to the new location. Ideally, I would redirect each indexed resource to the equivalent on the new site, but at minimum, I needed to redirect requests to the new start page. I had access to the old domain name for enough time, and therefore, I could run the site separately on both domain names at the same time.</p> <div class=line-block> <div class=line><br></div> </div> <p>There is one proper solution to this situation that should be used whenever possible: Permanent redirect, or the <a class="reference external" href=https://tools.ietf.org/html/rfc2616#section-10.3.2>301 Moved Permanently</a> status code, is the way to redirect pages implemented in the HTTP protocol. The only issue is that it's supposed to happen on the server side within a server response's HTTP header. But the only solution I could implement resides on a client side; that is, either HTML code or JavaScript. I didn't consider the JS variant because I didn't want to rely on the script's support in web browsers. Once I defined the task, I recalled a solution: the <a class="reference external" href=https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta>HTML &lt;meta&gt; tag</a> <em>&lt;meta http-equiv&gt;</em> with the '<a class="reference external" href=http://www.otsukare.info/2015/03/26/refresh-http-header>refresh</a>' <a class="reference external" href=https://tools.ietf.org/html/rfc2616#section-14>HTTP header</a>. Although it can be used to ask browsers to reload a page or jump to another URL after a specified number of seconds, after some research, I learned it is more complicated than I thought with some interesting facts and details.</p> <div class=section id=the-solution> <h2>The solution</h2> <p><strong>TL;DR</strong> (for anyone who isn't interested in all the details): In brief, this solution configures two repositories to serve as static websites with custom domain names. On the site with the old domain, I reconstructed the website's entire directory structure and put the following <em>index.html</em> in each of them (including the root):</p> <div class=highlight><pre><span></span><span class=cp>&lt;!DOCTYPE HTML&gt;</span>
<span class=p>&lt;</span><span class=nt>html</span> <span class=na>lang</span><span class=o>=</span><span class=s>&quot;en&quot;</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&quot;utf-8&quot;</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&quot;robots&quot;</span> <span class=na>content</span><span class=o>=</span><span class=s>&quot;noindex, nofollow&quot;</span> <span class=p>/&gt;</span>
        <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>http-equiv</span><span class=o>=</span><span class=s>&quot;refresh&quot;</span> <span class=na>content</span><span class=o>=</span><span class=s>&quot;0;url={{THE_NEW_URL}}&quot;</span> <span class=p>/&gt;</span>
        <span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&quot;canonical&quot;</span> <span class=na>href</span><span class=o>=</span><span class=s>&quot;{{THE_NEW_URL}}&quot;</span> <span class=p>/&gt;</span>
    <span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>
            The page been moved to <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&quot;{{THE_NEW_URL}}&quot;</span><span class=p>&gt;</span>{{THE_NEW_URL}}<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
        <span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
    <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</pre></div> <p>When someone opens a resource on the old domain, most web browsers &quot;immediately&quot; redirect to the same resource on the new website (thanks to <em>http-equiv=&quot;refresh&quot;</em>). For any resources that were missed or nonexistent, it is helpful to create a <em>404.html</em> file in the old website's root directory with the similar content, but without <em>rel=&quot;canonical&quot;</em> because there is no a canonical page for this case.</p> <div class=line-block> <div class=line><br></div> </div> <p>Another <a class="reference external" href=https://developers.google.com/search/reference/robots_meta_tag>HTML &lt;meta&gt; tag &quot;robots&quot;</a> tells search engines to remove a <a href=https://vorakl.com/articles/remove-webpage-google/ class="reference external">page from search results</a>.</p> <div class=line-block> <div class=line><br></div> </div> <p>The last piece of the puzzle is the <a class="reference external" href=https://tools.ietf.org/html/rfc6596>canonical link relation</a> (<em>rel=&quot;canonical&quot;</em>), which prevents duplicating content as long as the implemented redirect <strong>is not permanent</strong>. From the HTTP response's perspective, it happens when <a class="reference external" href=https://tools.ietf.org/html/rfc2616#section-10.2.1>the request has succeeded</a> and there is an indication for search engines that a resource has moved and should be associated with a new (preferred) location.</p> <div class=line-block> <div class=line><br></div> </div> <p>I have learned a few interesting facts related to <em>http-equiv=&quot;refresh&quot;</em> and <em>rel=&quot;canonical&quot;</em>. The HTML &lt;meta&gt; tag <em>http-equiv</em> is used to <strong>simulate</strong> the presence of an HTTP header in a server response. That is, web developers without access to the web server's configuration can get a similar result by &quot;injecting&quot; HTTP headers from an HTML document (the &quot;body&quot; of an HTTP response). It seems the <em>refresh</em> header, which has been used by all popular web browsers for many years, <strong>doesn't really exist</strong>. At least not as a standardized HTTP header. There was a plan to add it in the HTTP/1.1 specification that was <a class="reference external" href=https://lists.w3.org/Archives/Public/ietf-http-wg-old/1996MayAug/0594.html>deferred to HTTP/1.2</a> (or later), but it never happened.</p> <div class=line-block> <div class=line><br></div> </div> <p>The task of finding the real source URL for a resource is far from trivial. There are different scheme names (HTTP, HTTPS), multiple query parameters (page.html, page.html?a=1), various hostnames that resolve to the same IP address, etc. All of these options make a webpage look different to search engines, but the page is still the same. It gets even worse when the same content is published on independent web services. In 2009, Google, Yahoo, and Microsoft announced <a href=https://www.mattcutts.com/blog/canonical-link-tag/ class="reference external">support for a canonical link element</a> to clean up duplicate URLs on sites by allowing webmasters to choose a canonical (preferred) URL for a group of possible URLs for the same page. This helps search engines pick up the correct URL to associate with the content and can also improve <a href=https://yoast.com/rel-canonical/ class="reference external">SEO for a site</a>.</p> <!-- Links --> </div> </div> </div> <div class=article style="text-align: center; font-size: 1.1em; font-style: italic"> Found a <span style="color: red; font-weight: bold">bug</span> or <span style="color: red; font-weight: bold">typo</span>? Please, send me <a href=/pages/feedback/ >feedback</a> or submit a <a href=https://github.com/vorakl/vorakl.github.io/blob/master/src.docs/content/articles/canonical.rst>PR on Github</a>. </div> <div class=article> <div class="well small"><h5>This is my personal blog. All ideas, opinions, examples, and other information that can be found here are my own and belong entirely to me. This is the result of my personal efforts and activities at my free time. It doesn't relate to any professional work I've done and doesn't have correlations with any companies I worked for, I'm currently working, or will work in the future.</h5></div> </div> </div> </div> </div> <footer> <div class=container> <div class=row> <div class=span5> <span class=pull-left> &copy; 2019 <a href=https://vorakl.com/pages/about/ >vorakl</a> All Rights Reserved </span> </div> <div class=span7> <div class=pull-right> Powered by <a href=https://github.com/getpelican/pelican>Pelican</a> and <a href=https://github.com/vorakl/aves>Aves</a> theme </div> </div> </div> </div> </footer> </div> </body> </html>